"use strict";function array_to_hash(r){var t=Object.create(null);for(var e=0;e<r.length;++e)t[r[e]]=true;return t}function slice(r,t){return Array.prototype.slice.call(r,t||0)}function characters(r){return r.split("")}function member(r,t){for(var e=t.length;--e>=0;)if(t[e]==r)return true;return false}function find_if(r,t){for(var e=0,n=t.length;e<n;++e){if(r(t[e]))return t[e]}}function repeat_string(r,t){if(t<=0)return"";if(t==1)return r;var e=repeat_string(r,t>>1);e+=e;if(t&1)e+=r;return e}function DefaultsError(r,t){Error.call(this,r);this.msg=r;this.defs=t}DefaultsError.prototype=Object.create(Error.prototype);DefaultsError.prototype.constructor=DefaultsError;DefaultsError.croak=function(r,t){throw new DefaultsError(r,t)};function defaults(r,t,e){if(r===true)r={};var n=r||{};if(e)for(var i in n)if(n.hasOwnProperty(i)&&!t.hasOwnProperty(i))DefaultsError.croak("`"+i+"` is not a supported option",t);for(var i in t)if(t.hasOwnProperty(i)){n[i]=r&&r.hasOwnProperty(i)?r[i]:t[i]}return n}function merge(r,t){for(var e in t)if(t.hasOwnProperty(e)){r[e]=t[e]}return r}function noop(){}var MAP=function(){function r(r,s,u){var f=[],o=[],a;function c(){var c=s(r[a],a);var l=c instanceof i;if(l)c=c.v;if(c instanceof e){c=c.v;if(c instanceof n){o.push.apply(o,u?c.v.slice().reverse():c.v)}else{o.push(c)}}else if(c!==t){if(c instanceof n){f.push.apply(f,u?c.v.slice().reverse():c.v)}else{f.push(c)}}return l}if(r instanceof Array){if(u){for(a=r.length;--a>=0;)if(c())break;f.reverse();o.reverse()}else{for(a=0;a<r.length;++a)if(c())break}}else{for(a in r)if(r.hasOwnProperty(a))if(c())break}return o.concat(f)}r.at_top=function(r){return new e(r)};r.splice=function(r){return new n(r)};r.last=function(r){return new i(r)};var t=r.skip={};function e(r){this.v=r}function n(r){this.v=r}function i(r){this.v=r}return r}();function push_uniq(r,t){if(r.indexOf(t)<0)r.push(t)}function string_template(r,t){return r.replace(/\{(.+?)\}/g,function(r,e){return t[e]})}function remove(r,t){for(var e=r.length;--e>=0;){if(r[e]===t)r.splice(e,1)}}function mergeSort(r,t){if(r.length<2)return r.slice();function e(r,e){var n=[],i=0,s=0,u=0;while(i<r.length&&s<e.length){t(r[i],e[s])<=0?n[u++]=r[i++]:n[u++]=e[s++]}if(i<r.length)n.push.apply(n,r.slice(i));if(s<e.length)n.push.apply(n,e.slice(s));return n}function n(r){if(r.length<=1)return r;var t=Math.floor(r.length/2),i=r.slice(0,t),s=r.slice(t);i=n(i);s=n(s);return e(i,s)}return n(r)}function set_difference(r,t){return r.filter(function(r){return t.indexOf(r)<0})}function set_intersection(r,t){return r.filter(function(r){return t.indexOf(r)>=0})}function makePredicate(r){if(!(r instanceof Array))r=r.split(" ");var t="",e=[];r:for(var n=0;n<r.length;++n){for(var i=0;i<e.length;++i)if(e[i][0].length==r[n].length){e[i].push(r[n]);continue r}e.push([r[n]])}function s(r){if(r.length==1)return t+="return str === "+JSON.stringify(r[0])+";";t+="switch(str){";for(var e=0;e<r.length;++e)t+="case "+JSON.stringify(r[e])+":";t+="return true}return false;"}if(e.length>3){e.sort(function(r,t){return t.length-r.length});t+="switch(str.length){";for(var n=0;n<e.length;++n){var u=e[n];t+="case "+u[0].length+":";s(u)}t+="}"}else{s(r)}return new Function("str",t)}function all(r,t){for(var e=r.length;--e>=0;)if(!t(r[e]))return false;return true}function Dictionary(){this._values=Object.create(null);this._size=0}Dictionary.prototype={set:function(r,t){if(!this.has(r))++this._size;this._values["$"+r]=t;return this},add:function(r,t){if(this.has(r)){this.get(r).push(t)}else{this.set(r,[t])}return this},get:function(r){return this._values["$"+r]},del:function(r){if(this.has(r)){--this._size;delete this._values["$"+r]}return this},has:function(r){return"$"+r in this._values},each:function(r){for(var t in this._values)r(this._values[t],t.substr(1))},size:function(){return this._size},map:function(r){var t=[];for(var e in this._values)t.push(r(this._values[e],e.substr(1)));return t}};