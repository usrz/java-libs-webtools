"use strict";function array_to_hash(r){for(var t=Object.create(null),n=0;n<r.length;++n)t[r[n]]=!0;return t}function slice(r,t){return Array.prototype.slice.call(r,t||0)}function characters(r){return r.split("")}function member(r,t){for(var n=t.length;--n>=0;)if(t[n]==r)return!0;return!1}function find_if(r,t){for(var n=0,e=t.length;e>n;++n)if(r(t[n]))return t[n]}function repeat_string(r,t){if(0>=t)return"";if(1==t)return r;var n=repeat_string(r,t>>1);return n+=n,1&t&&(n+=r),n}function DefaultsError(r,t){Error.call(this,r),this.msg=r,this.defs=t}function defaults(r,t,n){r===!0&&(r={});var e=r||{};if(n)for(var i in e)e.hasOwnProperty(i)&&!t.hasOwnProperty(i)&&DefaultsError.croak("`"+i+"` is not a supported option",t);for(var i in t)t.hasOwnProperty(i)&&(e[i]=r&&r.hasOwnProperty(i)?r[i]:t[i]);return e}function merge(r,t){for(var n in t)t.hasOwnProperty(n)&&(r[n]=t[n]);return r}function noop(){}function push_uniq(r,t){r.indexOf(t)<0&&r.push(t)}function string_template(r,t){return r.replace(/\{(.+?)\}/g,function(r,n){return t[n]})}function remove(r,t){for(var n=r.length;--n>=0;)r[n]===t&&r.splice(n,1)}function mergeSort(r,t){function n(r,n){for(var e=[],i=0,s=0,u=0;i<r.length&&s<n.length;)e[u++]=t(r[i],n[s])<=0?r[i++]:n[s++];return i<r.length&&e.push.apply(e,r.slice(i)),s<n.length&&e.push.apply(e,n.slice(s)),e}function e(r){if(r.length<=1)return r;var t=Math.floor(r.length/2),i=r.slice(0,t),s=r.slice(t);return i=e(i),s=e(s),n(i,s)}return r.length<2?r.slice():e(r)}function set_difference(r,t){return r.filter(function(r){return t.indexOf(r)<0})}function set_intersection(r,t){return r.filter(function(r){return t.indexOf(r)>=0})}function makePredicate(r){function t(r){if(1==r.length)return n+="return str === "+JSON.stringify(r[0])+";";n+="switch(str){";for(var t=0;t<r.length;++t)n+="case "+JSON.stringify(r[t])+":";n+="return true}return false;"}r instanceof Array||(r=r.split(" "));var n="",e=[];r:for(var i=0;i<r.length;++i){for(var s=0;s<e.length;++s)if(e[s][0].length==r[i].length){e[s].push(r[i]);continue r}e.push([r[i]])}if(e.length>3){e.sort(function(r,t){return t.length-r.length}),n+="switch(str.length){";for(var i=0;i<e.length;++i){var u=e[i];n+="case "+u[0].length+":",t(u)}n+="}"}else t(r);return new Function("str",n)}function all(r,t){for(var n=r.length;--n>=0;)if(!t(r[n]))return!1;return!0}function Dictionary(){this._values=Object.create(null),this._size=0}DefaultsError.prototype=Object.create(Error.prototype),DefaultsError.prototype.constructor=DefaultsError,DefaultsError.croak=function(r,t){throw new DefaultsError(r,t)};var MAP=function(){function r(r,s,u){function o(){var o=s(r[f],f),h=o instanceof e;return h&&(o=o.v),o instanceof t?(o=o.v,o instanceof n?c.push.apply(c,u?o.v.slice().reverse():o.v):c.push(o)):o!==i&&(o instanceof n?a.push.apply(a,u?o.v.slice().reverse():o.v):a.push(o)),h}var f,a=[],c=[];if(r instanceof Array)if(u){for(f=r.length;--f>=0&&!o(););a.reverse(),c.reverse()}else for(f=0;f<r.length&&!o();++f);else for(f in r)if(r.hasOwnProperty(f)&&o())break;return c.concat(a)}function t(r){this.v=r}function n(r){this.v=r}function e(r){this.v=r}r.at_top=function(r){return new t(r)},r.splice=function(r){return new n(r)},r.last=function(r){return new e(r)};var i=r.skip={};return r}();Dictionary.prototype={set:function(r,t){return this.has(r)||++this._size,this._values["$"+r]=t,this},add:function(r,t){return this.has(r)?this.get(r).push(t):this.set(r,[t]),this},get:function(r){return this._values["$"+r]},del:function(r){return this.has(r)&&(--this._size,delete this._values["$"+r]),this},has:function(r){return"$"+r in this._values},each:function(r){for(var t in this._values)r(this._values[t],t.substr(1))},size:function(){return this._size},map:function(r){var t=[];for(var n in this._values)t.push(r(this._values[n],n.substr(1)));return t}};